<!--   点击后查看详情页面  来自voidxin，创建于2016年12月20日,  转载请声明 --><template>   <wxc-navpage data-role="none" height={{navBarHeight}} background-color=rgb(246,246,246) title={{title}} title-color=rgb(44,112,223)  left-item-src="http://7xwl0f.com1.z0.glb.clouddn.com/ic_arrow_nor@2x.png">  <list >     <cell if={{datas.user}} style="height: 300;margin-top: 30;">       <div style="height: 125;justify-content: center;">         <text style="font-size: 45;lines:3;height: 125;margin-left: 20;margin-right: 30;font-weight: 70;">{{datas.title}}</text>       </div>       <div  style="flex-direction: row;height: 125;">         <div style="flex: 0.2; align-items: center;justify-content: center;">           <image src="{{users.userAvatar}}" style="height: 110;width: 110;border-radius: 55;"></image>         </div>         <div style="flex: 0.8;justify-content: center;" >           <text style="font-size: 35;color: blue; flex: 0.5;lines:1;">{{datas.src}}</text>           <text style="font-size: 32;color: gray; flex: 0.5;lines:1;">已有{{fances}}万人关注 {{datas.publishTime}}</text>         </div>       </div>     </cell>      <cell if={{!datas.user}} style="height: 175;margin-top: 30;">       <div style="height: 125;justify-content: center;">         <text style="font-size: 45;lines:3;height: 125;margin-left: 20;margin-right: 30;font-weight: 70;">{{datas.title}}</text>       </div>       <div  style="flex-direction: row;height: 50;align-items: center;">         <text style="color:gray;font-size:30;margin-left:30;">{{datas.src}} {{datas.publishTime}}</text>       </div>     </cell>     <!-- 内容 -->            <cell repeat="{{contents}}" style="margin-top:{{!datas.user?30:0}};">        <div if={{type==1}} style="margin-top:30;">          <text style=";font-size: 40;margin-left: 30;margin-right: 30;font-weight: normal;font-style:normal ">{{content}}</text>         </div>         <div  if={{type==2}} style="justify-content: center;align-items: center;margin-top: 15;">          <image src="{{content}}" resize="cover" style="height:{{style[0].height}};width: {{style[0].width}};"></image>         </div>         <!-- type=200显示图片 -->         <div if={{type==200}} style=";margin-top: 15;">             <div style="flex-direction: row;margin-left: 0;justify-content: center;align-content: center;">                <image src="{{content}}" resize="cover" style="height:{{style[0].height}};width: {{style[0].width}};"></image>             </div>          </div>         <!-- type=3是表格 -->         <div if={{type==3}} style="margin-top: 30;">           <div repeat="item in tableData.content">             <div style="flex-direction: row;">                <div repeat="dic in item" style="justify-content: center;">                                      <div style="align-items: center;justify-content: center;align-content: center;width: {{screenW / item.length}};margin-left:0;">                     <text style="font-size: 30;">{{dic.content}}</text>                   </div>                </div>             </div>              <div style="background-color: rgb(235,235,235);height:1;"></div>           </div>         </div>     </cell>    <!--  相关新闻 -->    <cell  style="height:50;background-color: rgb(235,235,235);margin-top: 45;"></cell>    <cell style="height:100;align-items: center;flex-direction:row;margin-top:30">         <div style="height: 55;width: 8;background-color: blue;"></div>         <text style="font-size: 35;color: gray;left: 30;">相关新闻</text>         <div style="background-color: rgb(237,237,237);height: 1;left: 0;right: 0;bottom: 0;position:absolute;"></div>       </cell>     <cell repeat="{{relatedList}}" style="margin-top: 35;" onclick="toutiaoClicked($index)">         <div if={{type!=23}} style="height: 200;flex-direction: row;">                <div style="flex:0.3;justify-content: center;align-content: center;align-items: center;">                   <image src={{picCover}} style="width: 200;height: 150;" resize="cover"></image>                 </div>             <div style="flex:0.7;justify-content: center;">                 <div style="height: 150;">                     <div style="flex: 0.7;justify-content: center;">                       <text style="font-size: 35;margin-left: 15;margin-right: 15;text-align: left;lines:3;height: 100;" >{{title}}</text>                     </div>                     <div style="flex-direction: row;flex: 0.3;">                       <div style="flex: 0.7;justify-content: center;">                         <text style="margin-left: 15;margin-right: 5;font-size: 25;color: gray;">{{src}}</text>                       </div>                       <div style="flex:0.3;justify-content: center; flex-direction: row; justify-content: center;align-items: center;">                         <image src="http://7xwl0f.com1.z0.glb.clouddn.com/comment_comunity_ngt@2x.png" style="height: 25;width: 25;"></image>                         <text style="margin-right: 15;margin-left: 15;font-size: 25;color: gray;">{{commentCount}}</text>                       </div>                     </div>                </div>             </div>             <div style="background-color: rgb(237,237,237);height: 1;left: 0;right: 0;bottom: 0;position:absolute;"></div>         </div>        <!--  type=23时显示多张图片 -->         <div if={{type==23}} style="height: 310;" onclick="toutiaoClicked($index)">            <div style="height: 70;justify-content: center;align-content: center;">              <text style="font-size: 35;lines:2;margin-left: 15;margin-right: 15;">{{title}}</text>            </div>            <div style="height:170;flex-direction: row;">              <div repeat="{{images}}" style="align-content: center;justify-content: center;align-items: center;">                 <image src="{{url}}" style="margin-left:15;height: 150;width: {{screenW / images.length - 20}};" resize="cover"></image>              </div>            </div>            <div style="height: 70; justify-content: center;flex-direction: row;">              <div style="flex:0.6;justify-content: center;">                <text style="left: 15;lines:1; text-align: left;color: gray;">{{src}}</text>              </div>               <div style="flex: 0.4;justify-content: center;">                <text style="right: 15;lines:1;text-align: right;color: gray;">{{commentCount}}评论</text>              </div>            </div>            <div style="background-color: rgb(237,237,237);height: 1;left: 0;right: 0;bottom: 0;position:absolute;"></div>         </div>      </cell>    <!-- 分割线 -->     <cell  style="height:50;background-color: rgb(235,235,235);margin-top: 45;"></cell>      <!-- 相关车型 -->       <cell style="height:100;align-items: center;flex-direction:row;margin-top:30">         <div style="height: 55;width: 8;background-color: blue;"></div>         <text style="font-size: 35;color: gray;left: 30;">相关车型</text>         <div style="background-color: rgb(237,237,237);height: 1;left: 0;right: 0;bottom: 0;position:absolute;"></div>       </cell>     <cell repeat="{{carserialData}}" style="height: 200;flex-direction: row;" >                  <div style="flex:0.3;justify-content: center;align-content: center;align-items: center;">           <image src={{coverurl}} style="width: 200;height: 150;" resize="cover"></image>         </div>         <div style="flex:0.7;justify-content: center;">             <div style="height: 150;flex-direction:row;">                 <div style="flex:0.6;justify-content:center;">                   <text style="font-size:40;">{{name}}</text>                   <text style="font-size:30;color:red;margin-top:15;">{{price}}</text>                 </div>                 <div style="flex:0.4;justify-content:center;">                  <wxc-button type="success" size="small" value="询问底价" onclick="askedPriceClicked" style="background-color:rgb(44,112,223);border-color:rgb(44,112,223);width:180;height:80;"></wxc-button>                                    </div>            </div>         </div>         <div style="background-color: rgb(237,237,237);height: 1;left: 0;right: 0;bottom: 0;position:absolute;"></div>      </cell>      <!-- 最新评论 -->      <cell style="height:40;background-color: rgb(235,235,235);"></cell>       <cell style="height:100;align-items: center;flex-direction:row;">         <div style="height: 55;width: 8;background-color: blue;"></div>         <text style="font-size: 35;color: gray;left: 30;">最新评论</text>       </cell>      <cell repeat="{{commentList}}" >          <div style="flex-direction:row;">              <div style="flex:0.2;align-content:center;align-items: center;margin-top:30;">                <image src="{{user.userAvatar}}" style="height:80;width:80;border-radius:40;"></image>              </div>              <div style="flex:0.8; margin-top:30;">                <div style="height:50;flex-direction:row;">                  <text style="font-size:33;color:gray;">{{user.nickName}}</text>                  <image src="http://7xwl0f.com1.z0.glb.clouddn.com/zhongdaxingche_night_off@2x.png" style="height:25;width:75;margin-left:8;"></image>                </div>                <!-- 评论内容 -->                <div style="font-size:35;margin-top:15;">                  <text>{{content}}</text>                 </div>                <div style="flex-direction:row;margin-top:30;">                    <div style="flex:0.8;justify-content:center;">                      <text style="height:30;margin-right:15;font-size:25;color:gray;">{{createtime}}</text>                    </div>                    <div style="flex:0.2;justify-content:center;">                      <image src="http://7xwl0f.com1.z0.glb.clouddn.com/comment_comunity_ngt@2x.png" style="height: 35;width: 35;margin-right:15;"></image>                    </div>                </div>              </div>          </div>          <div style="height:30;margin-top:0"></div>          <div style="background-color: rgb(237,237,237);height: 1;left: 0;right: 0;bottom: 0;position:absolute;"></div>      </cell>      <!-- 查看更多评论 -->      <cell style="height:120;justify-content:center;align-content:center;align-items:center;" >         <text style="font-size:35;color:rgb(44,112,223);" onclick="commentDetail">查看更多评论(共{{commentData.count}}条) ></text>      </cell>  </list>  <!-- 底部的评论视图 -->  <div style="height:120;background-color:rgb(246,246,246);flex-direction:row;">    <div style="flex:0.4;justify-content:center;margin-left:15;margin-right:15;">      <div style="background-color:white;border-radius:10;justify-content:center;height:80;" onclick="commentClicked">        <text style="font-size:30;color:gray;margin-left:15;">发射评论吧...</text>      </div>          </div>    <div style="flex:0.6;flex-direction:row;justify-content:center;align-items:center;">      <div style="flex:0.4;flex-direction:row;justify-content:center;" onclick="commentDetail">        <image src="http://7xwl0f.com1.z0.glb.clouddn.com/comment_comunity_nor_highlight@2x.png" style="height:40;width:40"></image>        <text style="font-size:28;color:rgb(44,112,223);margin-left:5;lines:1;height:40;">{{commentData.count}}</text>      </div>      <div style="flex:0.3;flex-direction:row;justify-content:center;">         <image src="http://7xwl0f.com1.z0.glb.clouddn.com/newsDetail_ic_share@2x.png" style="height:40;width:40"></image>      </div>      <div style="flex:0.3;flex-direction:row;justify-content:center;">        <image src="http://7xwl0f.com1.z0.glb.clouddn.com/newsDetail_ic_config@2x.png" style="height:40;width:40"></image>      </div>    </div>  </div> <!--  评论输入视图 -->  <div if="{{show}}" style="justify-content:center;background-color:rgb(171,171,171);position:fixed;opacity:0.80;filter:alpha(opacity=40);z-index: 99;left:0;top:0;bottom: 0;right:0;filter:alpha(opacity=40);justify-content: center;">  </div>  <div if="{{show}}" style="justify-content:center;height:500;z-index:190; background-color:rgb(246,246,246);position:fixed;left:30;top:200;bottom: 450;right:30; border-radius: 10;">       <div style="justify-content:center;align-items: center;flex-direction:row;flex:0.2;margin-top:15;">         <text style="flex:0.3; font-size:40;color:rgb(44,112,223);text-align:center;" onclick="cancelClicked">取消</text>         <text style="flex:0.4; font-size:45;text-align:center;" >评论</text>         <text style="flex:0.3; font-size:40;text-align:center;color:gray;" onclick="commentConfirmClicked">发布</text>       </div>       <div>        <textarea          class="input"          autofocus="true"          placeholder="点击输入..."          onchange="change"          input="input"          >        </textarea>       </div>    </div>  </wxc-navpage></template><style>  .input {    font-size: 35;    height: 370;    margin-left: 30;    margin-right: 30;    margin-bottom: 30;    border-radius: 7;    background-color: white;  }</style><script>  require('weex-components');  module.exports = {    data: {      navBarHeight:128,      baseURL:'',      dir:'',       //网络获取的数据      datas:{},      users:{},      fances:0,      contents:[],      styles:[],      carserialData:[],      commentData:{},      commentList:[],      show:false,      newsId:0,      tableDatas:[],      screenW:0,      //相关新闻      relatedList:[],     images:[{url:'http://image.bitautoimg.com/wapimg-216-144/appimage/cms/20161219/w480_h320_2eeb3bfca665445ea89f792b0d0e0df5.jpg'},{url:'http://image.bitautoimg.com/wapimg-216-144/appimage/cms/20161219/w480_h320_fbdeb99a5986437ba35c5f2f2bc7a2d7.jpg'},      {url:'http://image.bitautoimg.com/wapimg-216-144/appimage/cms/20161219/w480_h320_28b3175dd16949e0b3a47b9d1335e1ba.jpg'}],    },    ready:function(){        var self = this;        self.requestData();        self.requestRealData();        self.requestRelatedNewsData();         self.baseConfig();    },    created: function() {      var self = this;      var config  = self.$getConfig();      var url = config.bundleUrl;      self.title = decodeURIComponent(this._getUrlParam(url, 'icar_title'));      self.newsId = decodeURIComponent(this._getUrlParam(url,'newsId'));      self.loadBaseUrl();      //宽度      //在5s或se上获取的宽度用在slider上有bug，宽度不够      if(config.env.deviceWidth == 640){        self.screenW = 750;      }else{        self.screenW = config.env.deviceWidth;      }    },    methods: {      loadBaseUrl : function(){            var bundleUrl = this.$getConfig().bundleUrl;            bundleUrl = new String(bundleUrl);            var nativeBase;            var isAndroidAssets = bundleUrl.indexOf('file://assets/') >= 0;            var isiOSAssets = bundleUrl.indexOf('file:///') >= 0 && bundleUrl.indexOf('VXCar.app') > 0;            if (isAndroidAssets) {              nativeBase = 'file://assets/';            }            else if (isiOSAssets) {              nativeBase = bundleUrl.substring(0, bundleUrl.lastIndexOf('/') + 1);            }            else {              var host = 'localhost:12500';              var matches = /\/\/([^\/]+?)\//.exec(this.$getConfig().bundleUrl);              if (matches && matches.length >= 2) {                host = matches[1];              }              nativeBase = 'http://' + host + '/' + this.dir + '/dist/';            }            var h5Base = './index.html?page=./' + this.dir + '/dist/';            //Native端            var base = nativeBase;            //H5端            if (typeof window === 'object') {              base = h5Base;            }            this.baseURL = base;                 },      //评论数据      requestRealData : function(){        var self = this          var stream = require('@weex-module/stream')          var modal = require('@weex-module/modal')          var GET_URL = 'http://api.ycapp.yiche.com/appnews/GetStructRealData?newsId='+self.newsId+'&type=11&mediaId=(null)&deviceId=9A69644FB98984C33214173968CA602D&plat=2&voteids=(null)'          stream.fetch({            method: 'GET',            url: GET_URL,            type: 'json'          }, function(ret) {                              if (typeof ret == 'string') {              ret = JSON.parse(ret)            }            if (!ret.ok) {              modal.alert({                message: '获取数据失败',                okTitle: '好'              })            } else {                           if (typeof ret.data == 'string') {                ret.data = JSON.parse(ret.data)              }                              self.commentData = ret.data.data.commentData;                self.commentList = ret.data.data.commentData.commentList;                          }          },function(response){            // self.toastTips('get:' + GET_URL);          });      },      requestData : function(){         var self = this          var stream = require('@weex-module/stream')          var modal = require('@weex-module/modal')          var GET_URL = 'http://api.ycapp.yiche.com/appnews/GetStructNews?newsId='+self.newsId+'&ts=20161215074823&plat=2&theme=0&version=7.6'          self.toast('加载数据中...')          stream.fetch({            method: 'GET',            url: GET_URL,            type: 'json'          }, function(ret) {                             if (typeof ret == 'string') {              ret = JSON.parse(ret)            }            if (!ret.ok) {              modal.alert({                message: '获取数据失败',                okTitle: '好'              })            } else {                           if (typeof ret.data == 'string') {                ret.data = JSON.parse(ret.data)              }                            self.datas = ret.data.data;              if (ret.data.data.hasOwnProperty("user") ) {                self.users = ret.data.data.user;                //保留两位小数                self.fances = (ret.data.data.user.fansCount / 10000).toFixed(2);              }                            //内容              self.contents = ret.data.data.content;              //相关车型              self.carserialData = ret.data.data.carserialData;                          }          },function(response){            // self.toastTips('get:' + GET_URL);          });      },      //相关新闻      requestRelatedNewsData : function(){         var self = this          var stream = require('@weex-module/stream')          var modal = require('@weex-module/modal')          var GET_URL = 'http://extapi.ycapp.yiche.com/appnews/GetAllRelatedNewsList?DeviceId=9A69644FB98984C33214173968CA602D&newsId='+self.newsId+'&NewsType=0&Num=3&ts=20161220114255&plat=2'          stream.fetch({            method: 'GET',            url: GET_URL,            type: 'json'          }, function(ret) {                             if (typeof ret == 'string') {              ret = JSON.parse(ret)            }            if (!ret.ok) {              modal.alert({                message: '获取数据失败',                okTitle: '好'              })            } else {                           if (typeof ret.data == 'string') {                ret.data = JSON.parse(ret.data)              }                            self.relatedList = ret.data.data.list;                                       }          },function(response){            // self.toastTips('get:' + GET_URL);          });      },       toast: function(msg, duration) {        duration = duration || 6;        var modal = require('@weex-module/modal');        modal.toast({          'message': msg,          'duration': duration        });      },      //查看更多评论      commentDetail : function(){        this.push();      },      readMore : function(){        this.pudh();      },      //评论按钮点击事件      commentClicked : function(){         var self = this;         self.show = true;      },      //取消评论      cancelClicked : function(){          var self = this;        self.show = false;      },      //发布评论      commentConfirmClicked : function(){          var self = this;          self.show = false;      },      //输入框事件监听      change: function() {        this.toast('hehehehehehe');      },      input: function() {        this.toast('hehehehehehe');      },      //点击相关车型之后      toutiaoClicked : function(e){         var self = this          var dic = self.relatedList[e];          var newsId = dic.newsId;          var params = {            'url':  self.baseURL + 'contentDetail.js?icar_title=详情&newsId=' + newsId,            'animated' : 'true',          }         self.$call('navigator','push',params, function () {});      },      //询问底价点击事件      askedPriceClicked : function(){          var self = this          var params = {            'url':  self.baseURL + 'askedPrice.js',            'animated' : 'true',          }         self.$call('navigator','push',params, function () {});      },       push: function() {        var vm = this;        var params = {          'url':  vm.baseURL + 'comment.js?icar_title=评论&newsId=' + vm.newsId,          'animated' : 'true',        }        vm.$call('navigator','push',params, function () {});      },       _getUrl: function(url, key){                var isExits = url.indexOf(key);                if(isExits > -1){                    return url.split('url=')[1];                }      },      _getUrlParam: function(url, key){          var reg = new RegExp('[?|&]' + key + '=([^&]+)');          var match = url.match(reg);          return match && match[1];      },      baseConfig: function(){            var config  = this.$getConfig();            this.$on('naviBar.leftItem.click',function(e){                //pop back                var params = {                    'animated' : 'true',                }                var navigator = require('@weex-module/navigator');                navigator.pop(params, function(e) {});            });      },    },  }</script>